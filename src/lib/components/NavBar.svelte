<script lang="ts">
	import { theme } from '$lib/shared';
	import { faMoon, faSun } from '@fortawesome/free-solid-svg-icons';
	import Fa from 'svelte-fa';
	let { session } = $props();

	let firstSpin = $state(false);
	let secondSpin = $state(false);

	const handleSpinTransition = () => {
		if (firstSpin) {
			firstSpin = false;
			if (theme.value === 'dark') {
				theme.value = 'light';
			} else {
				theme.value = 'dark';
			}

			console.log(theme.value);

			secondSpin = true;
		} else {
			secondSpin = false;
		}
	};
</script>

<div class="fixed z-50 w-full border-b bg-bg-2 py-0.5">
	<div class="flex h-full items-center justify-between px-4">
		<a href="/" aria-label="Home">
			<svg viewBox="0 0 1375 930" aria-hidden="true" class="h-8" style="width:5rem;height:3.5rem"
				><path
					class="fill-text-1"
					d="M1208.523 267.697c-57.513 1.304-112.541 33.099-140.955 87.68-41.54 79.8-10.518 178.181 69.282 219.72 57.927 30.159 125.62 22.056 174.279-15.152v25.733h63v-138.41c.05-67.206-25.837-129.425-86.83-161.172l-.147.279-1.056-.574.132-.26c-1.758-.899-3.535-1.72-5.31-2.549l-1.25-.678-.033.063c-22.987-10.496-47.26-15.22-71.112-14.68zm-224.043 1.508a162.749 162.749 0 0 0-87.591 24.666c-76.35 47.606-99.649 148.088-52.04 224.438 47.6 76.349 148.091 99.649 224.43 52.039l-34.13-54.75c-32.38 20.2-73.52 19.84-105.55-.9-45.61-29.54-58.64-90.462-29.101-136.08 29.54-45.61 90.46-58.64 136.07-29.1l35.07-54.15a162.768 162.768 0 0 0-87.158-26.163zm-816.9.557a162.792 162.792 0 0 0-87.601 24.666c-76.34 47.61-99.639 148.09-52.04 224.44 47.61 76.338 148.09 99.64 224.44 52.04l-34.14-54.75c-32.38 20.19-73.51 19.84-105.55-.9-45.609-29.55-58.63-90.47-29.09-136.08 29.54-45.61 90.459-58.64 136.069-29.1l35.07-54.15a162.762 162.762 0 0 0-87.158-26.166zm527.379 3.855c-17.6 0-33.22 2.714-46.86 8.14-13.64 5.28-25.154 12.394-34.54 21.34-9.387 8.947-16.5 19.14-21.34 30.58-4.84 11.44-7.26 23.173-7.26 35.2 0 14.96 2.054 27.573 6.16 37.84 4.107 10.12 9.46 18.629 16.06 25.521a87.466 87.466 0 0 0 22.88 16.5 212.25 212.25 0 0 0 26.18 10.559 832.954 832.954 0 0 0 26.179 7.701c8.507 2.347 16.06 5.06 22.66 8.14 6.747 3.08 12.175 6.966 16.281 11.659 4.107 4.693 6.16 10.782 6.16 18.262 0 12.906-3.74 22.365-11.22 28.378-7.48 5.867-17.966 8.801-31.46 8.801-9.972 0-18.627-1.393-25.96-4.18-7.333-2.786-13.86-5.866-19.58-9.24a3208.364 3208.364 0 0 1-15.18-9.24c-4.4-2.787-14.568-9.502-18.754-10.787-3.409 3.986-7.53 11.085-10.726 15.406l-22 34.76c6.306 6.307 13.714 12.027 22.22 17.16 8.507 5.133 17.6 9.607 27.28 13.42a188.906 188.906 0 0 0 29.92 8.58c10.413 2.053 20.606 3.08 30.58 3.08 18.186 0 34.394-2.712 48.62-8.138 14.373-5.574 26.4-13.127 36.08-22.66 9.828-9.68 17.307-20.975 22.44-33.881 5.134-12.906 7.7-26.767 7.7-41.58 0-13.347-2.055-24.714-6.16-34.1-4.107-9.534-9.534-17.6-16.28-24.2-6.6-6.6-14.228-12.027-22.88-16.28a214.903 214.903 0 0 0-26.18-11 423.33 423.33 0 0 0-26.4-8.58c-8.507-2.64-16.133-5.5-22.88-8.58-6.6-3.08-11.954-6.747-16.06-11-4.107-4.254-6.16-9.606-6.16-16.06 0-10.12 3.374-18.113 10.12-23.98 6.894-6.013 17.308-9.02 31.24-9.02 8.068 0 15.253 1.1 21.56 3.3 6.306 2.053 11.88 4.4 16.72 7.04 4.987 2.64 9.386 5.06 13.2 7.26 3.959 2.054 12.466 6.05 16.482 6.264 3.178-1.499 4.693-3.975 10.799-13.744l18.478-34.541c-5.72-5.28-12.247-9.972-19.58-14.078-7.187-4.254-14.958-7.848-23.318-10.782-8.36-3.08-17.235-5.353-26.621-6.82-9.24-1.613-18.773-2.42-28.6-2.42zm-313.611 1.834c-57.514 1.304-112.542 33.098-140.95 87.676-41.549 79.81-10.53 178.18 69.27 219.73 58 30.189 125.789 22.03 174.46-15.298v26.119h63V453.303c2.896-65.397-26.557-127.982-87.009-159.451l-.084.16-1.039-.612.053-.103c-.417-.213-.84-.395-1.258-.604l-.861-.505-.043.072c-24.284-11.973-50.15-17.384-75.54-16.809zm828.35 56.766c15.707-.394 31.726 3.002 46.72 10.574l1.47.75c47.66 25.087 66.334 83.84 41.802 131.848-24.74 48.38-84.012 67.558-132.4 42.818-48.38-24.73-67.56-84.009-42.821-132.389 17.002-33.267 50.335-52.725 85.228-53.601zm-827.182 7.75c15.662-.393 31.632 2.988 46.588 10.513l1.582.807c47.676 25.07 66.37 83.847 41.824 131.852-24.73 48.39-84.011 67.557-132.4 42.828-48.38-24.74-67.56-84.009-42.82-132.399 17-33.267 50.333-52.725 85.226-53.601z"
				></path></svg
			>
		</a>
		<div class="flex gap-x-3">
			{#if !session}
				<a href="/auth/login" class="btn-primary h-8 px-3">Login</a>
				<a href="/auth/sign-up" class="btn-secondary h-8 px-3">Sign Up</a>
			{/if}
			<button
				class="flex aspect-square h-8 items-center justify-center rounded hover:bg-btn-hover"
				onclick={() => {
					if (!firstSpin && !secondSpin) {
						firstSpin = true;
					}
				}}
				onanimationend={handleSpinTransition}
				><Fa
					icon={theme.value === 'dark' ? faSun : faMoon}
					class="{(firstSpin && 'animate-spin-slow-1') ||
						(secondSpin && 'animate-spin-slow-2')} aspect-square text-themeicon"
				/></button
			>
		</div>
	</div>
</div>
